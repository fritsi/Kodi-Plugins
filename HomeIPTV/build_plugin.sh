#!/usr/bin/env bashset -euo pipefailSCRIPT_DIR="$(cd "$(dirname "$0")" || exit && pwd)"cd "$SCRIPT_DIR"PLUGIN_ID="$(sed -nE "s/^<addon .*id=\"([^\"]+)\".*$/\1/p" addon.xml | head -1)"PLUGIN_VERSION="$(sed -nE "s/^<addon .*version=\"([^\"]+)\".*$/\1/p" addon.xml | head -1)"mkdir -p buildZIP_FILENAME="$PLUGIN_ID-$PLUGIN_VERSION.zip"rm -rf "build/$ZIP_FILENAME" "build/$ZIP_FILENAME.tmp"mkdir -p "build/$ZIP_FILENAME.tmp/$PLUGIN_ID"cp -R lib "build/$ZIP_FILENAME.tmp/$PLUGIN_ID"/cp -R resources "build/$ZIP_FILENAME.tmp/$PLUGIN_ID"/cp addon.py addon.xml service.py "build/$ZIP_FILENAME.tmp/$PLUGIN_ID"/cd "build/$ZIP_FILENAME.tmp"zip -r "../$ZIP_FILENAME" "$PLUGIN_ID"cd ..rm -rf "$ZIP_FILENAME.tmp"